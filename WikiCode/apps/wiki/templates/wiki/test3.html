{% extends 'main.html' %}
{% load bootstrap3 %}
{% block page_name %}
    <div class="container" style="margin-top: 50px;" xmlns="http://www.w3.org/1999/html">
        <div class="row">
            <br>
        </div>
    </div>
    <div class="container">
        <div class="row">
        </div>
    </div>
{% endblock %}
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12"
                 style="border-left: 1px solid #d5d5d5;border-right: 1px solid #d5d5d5;min-height:500px;border-bottom: 1px solid #d5d5d5;">
                <div class="row">
                    <label class="text-center btn-primary btn-block">HELP</label>
                </div>
                <style>
                    .md-btn:hover {
                        background-color: white;
                        border-radius: 0px;
                        color: #337ab7;
                    }

                    .md-btn {
                        border: 0px solid black;
                        background-color: white;
                        color: white;
                    }

                    .md-comment:hover {
                        background-color: white;
                        border-radius: 0px;
                        color: #337ab7;
                    }

                    .md-comment {
                        border: 0px solid black;
                        background-color: white;
                        color: white;
                    }
                </style>
                <form action="{% url 'testform' %}" method="post">
                    {% csrf_token %}

                    <div class="col-xs-12 col-sm-12 col-md-12">
                        <div class="row">
                            <div class="col-xs-1 col-sm-1 col-md-1">
                                <div class="row">
                                    <a class="md-btn btn btn-default btn-block" id="md-btn-1"><i
                                            class="md-ico fa fa-pencil-square-o fa-2x"></i></a>
                                </div>
                            </div>
                            <div class="col-xs-11 col-sm-11 col-md-11">
                                <div class="row">
                                    <div class="md-hover" id="markdown-row-1"></div>
                                    <input type="hidden" name="md-elem-1" id="md-input-1">
                                </div>
                            </div>
                            <div class="col-xs-1 col-sm-1 col-md-1">
                                <div class="row">
                                    <a class="md-btn btn btn-default btn-block" id="md-btn-2"><i
                                            class="md-ico fa fa-pencil-square-o fa-2x"></i></a>
                                </div>
                            </div>
                            <div class="col-xs-11 col-sm-11 col-md-11">
                                <div class="row">
                                    <div class="md-hover" id="markdown-row-2"></div>
                                </div>
                            </div>
                            <div class="col-xs-1 col-sm-1 col-md-1">
                                <div class="row">
                                    <a class="md-btn btn btn-default btn-block" id="md-btn-3"><i
                                            class="md-ico fa fa-pencil-square-o fa-2x"></i></a>
                                </div>
                            </div>
                            <div class="col-xs-11 col-sm-11 col-md-11">
                                <div class="row">
                                    <div class="md-hover" id="markdown-row-3"></div>
                                </div>
                            </div>
                            <div class="col-xs-1 col-sm-1 col-md-1">
                                <div class="row">
                                    <a class="md-btn btn btn-default btn-block" id="md-btn-4"><i
                                            class="md-ico fa fa-pencil-square-o fa-2x"></i></a>
                                </div>
                            </div>
                            <div class="col-xs-11 col-sm-11 col-md-11">
                                <div class="row">
                                    <div class="md-hover" id="markdown-row-4"></div>
                                </div>
                            </div>
                        </div>
                    </div>
                <div class="col-xs-12 col-sm-12 col-md-12">
                    <div class="row">
                        <button type="submit" class="btn btn-block btn-default">Подтвердить изменения в публикации</button>
                    </div>
                </div>
                </form>

            </div>
        </div>
    </div>
{% endblock %}

{% block add_script %}
    <script>
        $(init);
        var md1 = '# Разработка на java #';
        var md2 = 'Впервые на джава начВпервые на джава начали прогать в 1997 годуВпервые на джава начали прогать в 1997 годуВпервые на джава начали прогать вВпервые на джава начали прогать в 1997 годуВпервые на джава начали прогать в 1997 годуВпервые на джава начали прогать вали прогать в 1997 годуВпервые на джава начали прогать в 1997 годуВпервые на джава начали прогать в 1997 годуВпервые на джава начали прогать в 1997 годуВпервые на джава начали прогать в 1997 году';
        var md3 = 'С тех пор многое что изменилось';
        var md4 = '```\nSystem.out.println("Hello world!");\n```';
        var md5 = '# Разработка на java #';
        var is_edit = false;


        document.getElementById('markdown-row-1').innerHTML =
                marked(md1);
        $('#markdown-row-1').attr('content', marked(md1));
        document.getElementById('markdown-row-2').innerHTML =
                marked(md2);
        document.getElementById('markdown-row-3').innerHTML =
                marked(md3);
        document.getElementById('markdown-row-4').innerHTML =
                marked(md4);
        document.getElementById('markdown-row-5').innerHTML =
                marked(md5);


        function init() {
            $('#md-btn-1').bind('click', showEdit1);
            $('#md-btn-2').bind('click', showEdit2);
        }

        function showEdit1() {
            if (!is_edit) {
                is_edit = true;
                document.getElementById('markdown-row-1').innerHTML =
                        '<textarea id="cur_textarea" class="btn-block" rows="10" style="resize: none;">' + md1 + '</textarea>' +
                        '<button type="button" id="cur_btn_accept" class="btn btn-default">Подтвердить изменение</button>' +
                        '<button type="button" id="cur_btn_cancel" class="btn btn-default">Отмена</button>';
                $('#cur_btn_accept').bind('click', closeTextArea);
                $('#cur_btn_cancel').bind('click', cancelTextArea);
                function closeTextArea() {
                    cur_text = $("#cur_textarea").val();
                    document.getElementById('markdown-row-1').innerHTML =
                            marked(cur_text);
                    md1 = cur_text;
                    is_edit = false;
                    $("#md-input-1").val(cur_text);
                }

                function cancelTextArea() {
                    document.getElementById('markdown-row-1').innerHTML =
                            marked(md1);
                    is_edit = false;
                }
            }
        }
        function showEdit2() {
            if (!is_edit) {
                is_edit = true;
                document.getElementById('markdown-row-2').innerHTML =
                        '<textarea id="cur_textarea" class="btn-block" rows="10" style="resize: none;">' + md2 + '</textarea>' +
                        '<button id="cur_btn_accept" class="btn btn-default">Подтвердить изменение</button>' +
                        '<button id="cur_btn_cancel" class="btn btn-default">Отмена</button>';
                $('#cur_btn_accept').bind('click', closeTextArea);
                $('#cur_btn_cancel').bind('click', cancelTextArea);
                function closeTextArea() {
                    cur_text = $("#cur_textarea").val();
                    document.getElementById('markdown-row-2').innerHTML =
                            marked(cur_text);
                    md2 = cur_text;
                    is_edit = false;
                }

                function cancelTextArea() {
                    document.getElementById('markdown-row-2').innerHTML =
                            marked(md2);
                    is_edit = false;
                }
            }
        }

    </script>
    <script type='text/javascript'>
        height = $('#markdown-row-1').height();
        $('#md-btn-1').attr('style', 'height: ' + height + 'px;')
        height = $('#markdown-row-2').height();
        $('#md-btn-2').attr('style', 'height: ' + height + 'px;')
        height = $('#markdown-row-3').height();
        $('#md-btn-3').attr('style', 'height: ' + height + 'px;')
        height = $('#markdown-row-4').height();
        $('#md-btn-4').attr('style', 'height: ' + height + 'px;')
        height = $('#markdown-row-5').height();
        $('#md-btn-5').attr('style', 'height: ' + height + 'px;')

    </script>

{% endblock %}