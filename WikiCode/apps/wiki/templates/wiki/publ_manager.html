<!--
    Copyright (C) 2016 Igor Soloduev <diahorver@gmail.com>

    This file is part of WikiCode.

    WikiCode is free software: you can redistribute it and/or modify
    it under the terms of the GNU Affero General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    WikiCode is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.

    You should have received a copy of the GNU Affero General Public License
    along with WikiCode.  If not, see <http://www.gnu.org/licenses/>.
-->
{% extends 'main.html' %}
{% load bootstrap3 %}
{% block page_name %}
    <div class="container" style="margin-top: 50px;" >
        <div class="row">
            <br>
        </div>
    </div>
    <div class="container">
        <div class="row">
        </div>
    </div>
{% endblock %}
{% block content %}
    <div class="container">
        <div class="row">
            <div id="main-block" class="col-xs-12 col-sm-12 col-md-12">
                <div class="row">
                    <label class="text-center btn-primary btn-block">УПРАВЛЕНИЕ КОНСПЕКТОМ</label>
                </div>

                <div class="row">
                    <hr>
                    <div class="col-xs-4"> <!-- required for floating -->
                        <!-- Nav tabs -->
                        <ul class="nav nav-tabs tabs-left">
                            <li class="active"><a href="#tab-lest-id1" data-toggle="tab">Редактирование</a></li>
                            <li><a href="#tab-lest-id3" data-toggle="tab">Отображение</a></li>
                            <li><a href="#tab-lest-id4" data-toggle="tab">Доступ</a></li>
                            <li><a href="#tab-lest-id5" data-toggle="tab">Версии</a></li>
                            <li><a href="#tab-lest-id6" data-toggle="tab">Файлы</a></li>
                            <li><a href="#tab-lest-id7" data-toggle="tab">Удаление</a></li>
                        </ul>
                        <hr>
                    </div>
                    <div class="col-xs-8">
                        <!-- Tab panes -->
                        <div class="tab-content">
                            <div class="tab-pane active" id="tab-lest-id1">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Заголовок конспекта</h4>
                                    </div>
                                    <div class="col-xs-7">
                                        <input class="form-control btn-block" style="border-radius: 0px;font-family: Courier;" value="{{ publication.title }}">
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Описание конспекта</h4>
                                    </div>
                                    <div class="col-xs-7">
                                        <textarea class="form-control btn-block" style="border-radius: 0px; resize: none; font-family: Courier;" rows="3" >{{ publication.description }}</textarea>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Путь к конспекту</h4>
                                    </div>
                                    <div class="col-xs-7">
                                        <input class="form-control btn-block" style="border-radius: 0px;font-family: Courier;" value="{{ tree_path }}">
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Markdown текст</h4>
                                        <a class="btn-link">Редактировать в редакторе StackEdit</a>
                                        <a class="btn-link">Справка по Markdown</a>
                                    </div>
                                    <div class="col-xs-7">
                                        <textarea class="form-control btn-block" style="border-radius: 0px; resize: none; font-family: Courier;"rows="12" >{{ publication.text }}</textarea>
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Теги конспекта</h4>
                                    </div>
                                    <div class="col-xs-7">
                                        <input class="form-control btn-block" style="border-radius: 0px;font-family: Courier;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">

                                    </div>
                                    <div class="col-xs-7">
                                        <button id="wiki-style-btn" class="btn btn-block">Сохранить изменения</button>
                                    </div>
                                </div>
                                <br>

                            </div>
                            <div class="tab-pane" id="tab-lest-id3">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Офорление конспекта</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Тема оформления</h4>
                                    </div>
                                    <div class="col-xs-7">
                                        <input class="form-control btn-block" type="number" style="border-radius: 0px;font-family: Courier;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Отображение тегов</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Общее комментирование</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Динамическое комментирование</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Динамическое редактирование</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Версии конспекта</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Возможность редактирования</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Возможность скачивания</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Возможность сохранения</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Отображение ссылок</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Отображение файлов</h4>
                                    </div>
                                    <div class="col-xs-7 text-right">
                                        <input type="checkbox" style="border-radius: 0px;font-family: Courier; width: 25px;height: 25px;" >
                                    </div>
                                </div>
                                <br>
                                <div class="row">
                                    <div class="col-xs-5">

                                    </div>
                                    <div class="col-xs-7">
                                        <button id="wiki-style-btn" class="btn btn-block">Сохранить изменения</button>
                                    </div>
                                </div>
                                <br>
                            </div>
                            <div class="tab-pane" id="tab-lest-id4">
                                <form action="{% url 'save_access' publication.id_publication %}" method="post">
                                    {% csrf_token %}
                                    <div class="row">
                                        <div class="col-xs-5">
                                            <h4>Уровень доступа</h4>
                                        </div>
                                        <div class="col-xs-7 text-right">
                                            <select class="form-control btn-block" style="border-radius: 0px;font-family: Courier;" name="level_access">
                                                <option {% if publication.is_private %}selected{% endif %}>Приватный</option>
                                                <option {% if publication.is_public %}selected{% endif %}>Публичный</option>
                                            </select>
                                        </div>
                                    </div>
                                    {% if publication.is_private %}
                                        <br><hr>
                                        <div class="row">
                                            <div class="col-xs-5">
                                                <h4>Редакторы</h4>
                                            </div>
                                            <div class="col-xs-7 text-right">
                                                <select  id="select-list-editors" class="form-control btn-block" style="border-radius: 0px;font-family: Courier;" name="publ_editors">
                                                    {% for editor in editors %}
                                                        <option>{{ editor.nickname_user }}</option>
                                                    {% endfor %}
                                                </select>
                                                <button type="button" class="btn btn-block btn-default" style="border-radius: 0px;" data-toggle="modal" data-target="#modal_add_editor">Назначить нового</button>
                                                <button id="remove-select-editor" type="button" class="btn btn-block btn-default" style="border-radius: 0px;">Убрать выбранного</button>
                                            </div>
                                        </div>
                                    {% endif %}
                                    <br><hr>
                                    <div class="row">
                                        <div class="col-xs-5">

                                            <h4>Черный список</h4>
                                        </div>
                                        <div class="col-xs-7 text-right">
                                            <select class="form-control btn-block" style="border-radius: 0px;font-family: Courier;" name="publ_black_list">

                                            </select>
                                            <button type="button" class="btn btn-block btn-default" style="border-radius: 0px;">Добавить пользователя</button>
                                            <button type="button" class="btn btn-block btn-default" style="border-radius: 0px;">Убрать выбранного</button>
                                        </div>
                                    </div>
                                    <br><hr>
                                    <div class="row">
                                        <div class="col-xs-5">

                                        </div>
                                        <div class="col-xs-7">
                                            <button type="submit" id="wiki-style-btn" class="btn btn-block">Сохранить изменения</button>
                                        </div>
                                    </div>
                                    <br>
                                </form>
                            </div>
                            <div class="tab-pane" id="tab-lest-id5">
                                <h4>Текущая ветка:</h4>
                            </div>
                            <div class="tab-pane" id="tab-lest-id6">
                                <h4>Все файлы:</h4>
                            </div>
                            <div class="tab-pane" id="tab-lest-id7">
                                <div class="row">
                                    <div class="col-xs-5">
                                        <h4>Удаление конспекта</h4>
                                    </div>
                                    <div class="col-xs-7">
                                        <button id="wiki-style-btn" class="btn btn-block" data-toggle="modal" data-target="#myModal">Удалить конспект</button>
                                    </div>
                                </div>
                                <br>
                            </div>
                        </div>
                        <hr>
                    </div>

                </div>

            </div>
        </div>
    </div>



    <!-- Modal -->
    <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Вы действительно хотите удалить этот конспект?</h4>
                    <h4 class="modal-title" id="myModalLabel"><b>{{ tree_path }}</b></h4>
                    <h4 class="modal-title" id="myModalLabel"><b>{{ publication.title }}</b></h4>
                    <input id="myModalLabelTitlePublication" hidden value="{{ publication.tree_path }}">
                </div>
                <div class="modal-body">
                    <label><h4>ВНИМАНИЕ:</h4></label>
                    <h4>После удаления конспекта, все пользователи, сохранившие его к себе в дерево, потеряют к нему доступ.</h4>
                    <h4>После удаления конспекта, будут удалены все его версии, файлы, ссылки и комментарии.</h4>
                    <h4>После удаления конспекта, вы потеряете его "Лайки", "Сохранения", "Просмотры"  и т.д. Соответственно, ваша общая статистика может пострадать.</h4>
                    <h4>Удаление конспекта НЕОБРАТИМАЯ операция. Вы не сможете его потом восстановить.</h4>
                    <hr>
                    <h4>Вы уверены, что хотите его удалить?</h4>
                </div>
                <div class="modal-footer">
                    <button id="wiki-style-btn" type="button" class="btn" data-dismiss="modal">Отмена</button>
                    <button id="wiki-style-btn-delete-publ"type="button" class="btn">Да, я хочу его удалить</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно для добавления нового редактора конспекта -->
    <div class="modal fade" id="modal_add_editor" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Добавление нового редактора этого конспекта</h4>
                </div>
                <div class="modal-body">
                    <h4>Введите nickname пользователя, которого хотите назначить редактором:</h4>
                    <input id="id_publ_for_add_editor" style="display: none;" hidden value="{{ publication.id_publication }}">
                    <input id="input-for-add-editor" class="form-control" type="text" style="border-radius: 0px; font-family: Courier;" placeholder="Введите nickname...">
                    <label id="info-message-for-add-editor"><h4></h4></label>
                    <h4>Можете назначить редактором одного из своих коллег:</h4>
                    <select class="form-control btn-block" style="border-radius: 0px;font-family: Courier;" name="my_colleagues">

                    </select>
                </div>
                <div class="modal-footer">
                    <button id="wiki-style-btn" type="button" class="btn" data-dismiss="modal">Отмена</button>
                    <button id="wiki-style-btn-add-editor"type="button" class="btn" data-dismiss="modal">Назначить</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Модальное окно для управления черным списком -->
    <div class="modal fade" id="modal_add_black_user" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="myModalLabel">Добавление нового редактора этого конспекта</h4>
                </div>
                <div class="modal-body">
                    <h4>Введите nickname пользователя, которого хотите назначить редактором:</h4>
                    <input class="form-control" type="text" style="border-radius: 0px; font-family: Courier;" placeholder="Введите nickname...">
                    <h4>Можете назначить редактором одного из своих коллег:</h4>
                    <select class="form-control btn-block" style="border-radius: 0px;font-family: Courier;" name="my_colleagues">

                    </select>
                </div>
                <div class="modal-footer">
                    <button id="wiki-style-btn" type="button" class="btn" data-dismiss="modal">Отмена</button>
                    <button id="wiki-style-btn"type="button" class="btn">Назначить</button>
                </div>
            </div>
        </div>
    </div>



{% endblock %}

{% block add_script %}
    {% load staticfiles %}
    <script src={% static "wiki/wiki_scripts/publ_manager.js"%}></script>
    <link href={% static "wiki/wiki_styles/publ_manager.css" %} type="text/css" rel="stylesheet">
    <link href={% static "wiki/bootstrapfiles/css/bootsrtap-vertical.css" %} type="text/css" rel="stylesheet">
{% endblock %}